import struct

'''
笑傲梦幻破解
解密服务器发来的数据包
'''

flag = 381990860
key = "FT@!xasd"

def decrypt_data(encrypted_data, key_array, flag):
    ret_buffer = bytearray()

    # Extract data length and encrypted data
    data_length = struct.unpack('i', encrypted_data[8:12])[0]
    encrypted_buffer = encrypted_data[12:]

    for i in range(len(encrypted_buffer)):
        decode_byte = encrypted_buffer[i] ^ key_array[i % len(key_array)]
        ret_buffer.append(decode_byte)
    return ret_buffer

key_array = key.encode()

# Replace with your encrypted data
encrypted_data = b'\xcc\xb7\xc4\x16\x01\x00\x00\x000\x00\x00\x00GT@!qasd=v$\x03BCBUweq\x10ZMQ\x07dnb\x10JRGQpvl\x03\x1dCIFwfs\x10JRQ\x19'
decrypted_data = decrypt_data(encrypted_data, key_array, flag)
decoded_str = decrypted_data[8:].decode('GB18030')
print(decoded_str)