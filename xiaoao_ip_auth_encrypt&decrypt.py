import base64

from pyDes import des, CBC, PAD_PKCS5

rgb_iv = bytes([18, 52, 86, 104, 144, 171, 205, 239])
key = "qq381990860"[:8].encode('utf-8')


def des_encrypt(input_string):
    try:
        cipher = des(key, CBC, rgb_iv, pad=None, padmode=PAD_PKCS5)
        padded_data = input_string.encode('utf-8')
        encrypted_data = cipher.encrypt(padded_data)
        encrypted_base64 = base64.b64encode(encrypted_data).decode('utf-8')
        return encrypted_base64
    except Exception:
        return None


def des_decrypt(input_string):
    try:
        cipher = des(key, CBC, rgb_iv, pad=None, padmode=PAD_PKCS5)
        encrypted_data = base64.b64decode(input_string)
        decrypted_data = cipher.decrypt(encrypted_data, padmode=PAD_PKCS5)
        return decrypted_data.decode('utf-8')
    except Exception:
        return None


if __name__ == "__main__":
    cipher = des_encrypt("42.51.64.141")
    print(cipher)
    decrypted_result = des_decrypt('X4QSA91Zo8uAIl0AzlRYSA==')
    print(decrypted_result)
